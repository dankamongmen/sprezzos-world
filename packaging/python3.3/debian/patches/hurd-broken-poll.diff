# DP: Fix build failure on hurd, working around poll() on systems
# DP: on which it returns an error on invalid FDs.

Index: b/Modules/selectmodule.c
===================================================================
--- a/Modules/selectmodule.c
+++ b/Modules/selectmodule.c
@@ -2095,7 +2095,7 @@
 
 static PyMethodDef select_methods[] = {
     {"select",          select_select,  METH_VARARGS,   select_doc},
-#ifdef HAVE_POLL
+#if defined(HAVE_POLL) && !defined(HAVE_BROKEN_POLL)
     {"poll",            select_poll,    METH_NOARGS,    poll_doc},
 #endif /* HAVE_POLL */
 #ifdef HAVE_SYS_DEVPOLL_H
@@ -2145,7 +2145,7 @@
     PyModule_AddIntConstant(m, "PIPE_BUF", PIPE_BUF);
 #endif
 
-#if defined(HAVE_POLL)
+#if defined(HAVE_POLL) && !defined(HAVE_BROKEN_POLL)
 #ifdef __APPLE__
     if (select_have_broken_poll()) {
         if (PyObject_DelAttrString(m, "poll") == -1) {
